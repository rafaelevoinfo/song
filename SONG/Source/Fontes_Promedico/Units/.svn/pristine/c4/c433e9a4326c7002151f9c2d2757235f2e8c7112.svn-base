unit pChatTelaModal;

interface

uses
  pDMChat, System.Generics.Collections, pChatTipos,

  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, pZero, Vcl.ExtCtrls, cxGraphics,
  cxControls, cxLookAndFeels, cxLookAndFeelPainters, dxSkinsCore,
  pmPromedicoSkin, cxSplitter, RVScroll, RichView, RVEdit, Vcl.StdCtrls, cxPC,
  cxScrollBox, dxDockPanel, dxDockControl;

type
  TfrmChatTelaModal = class(TfrmZero)
    Panel1: TPanel;
    cxSplitter1: TcxSplitter;
    rveMensagens: TRichViewEdit;
    Panel3: TPanel;
    pnlConversaEdit: TPanel;
    pnlConversaEditBotoes: TPanel;
    bttEnviar: TButton;
    bttSmiley: TButton;
    rveMensagensEdit: TRichViewEdit;
    spStatusUsuario: TShape;
    imgFotoUsuario: TImage;
    lblNomeUsuario: TLabel;
    lblStatusUsuario: TLabel;
    Button1: TButton;
    Button2: TButton;
    dockSiteSmileys: TdxDockSite;
    dxLayoutDockSite2: TdxLayoutDockSite;
    dockPanelSmileys: TdxDockPanel;
    slbSmileys: TcxScrollBox;
    procedure FormCreate(Sender: TObject);
  private
    DMChat: TDMChat;
    FSmileys: TDictionary<string, string>;
    FSmileysExpressaoRegular: string;
    procedure ppvAdicionarSmileys(Sender: TObject);
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmChatTelaModal: TfrmChatTelaModal;

implementation

{$R *.dfm}

procedure TfrmChatTelaModal.FormCreate(Sender: TObject);
begin
  inherited;
  DMChat := TDMChat.Create(Self);
  DMChat.Name := '';

  DMChat.Ac_Enviar.Caption := '';

  // Preparando a tela dos smileys
  dockSiteSmileys.Height := 200;
  dockSiteSmileys.Width := 318;
  dockSiteSmileys.Visible := False;
  dockSiteSmileys.AutoSize := False;
  dockPanelSmileys.AutoHide := True;
  dockPanelSmileys.CaptionButtons := [cbMaximize];

  // Montando os smileys
  TChatFuncoes.ppuAdicionarSmileysTela(dockSiteSmileys.Width, slbSmileys, DMChat.ImgCollectionSmileys.Items, ppvAdicionarSmileys, FSmileysExpressaoRegular, FSmileys);
end;

procedure TfrmChatTelaModal.ppvAdicionarSmileys(Sender: TObject);
begin
  if (Sender is TImage) and (TImage(Sender).Hint <> '') then
    TChatFuncoes.ppuInserirSmileysRichViewEdit(TImage(Sender).Picture.Graphic, TImage(Sender).Hint, rveMensagensEdit);
end;

end.
