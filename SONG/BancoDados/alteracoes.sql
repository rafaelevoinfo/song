

CREATE TABLE NOTIFICACAO (
    ID INTEGER NOT NULL,
    TIPO INTEGER);

ALTER TABLE NOTIFICACAO
ADD CONSTRAINT PK_NOTIFICACAO
PRIMARY KEY (ID);

CREATE SEQUENCE GEN_NOTIFICACAO;



update RDB$RELATION_FIELDS set
RDB$NULL_FLAG = 1
where (RDB$FIELD_NAME = 'TIPO') and
(RDB$RELATION_NAME = 'NOTIFICACAO')
;



ALTER TABLE NOTIFICACAO
    ADD TEMPO_ANTECEDENCIA INTEGER;

COMMENT ON COLUMN NOTIFICACAO.TEMPO_ANTECEDENCIA IS
'Tempo de antecedencia em dias que a notifição deverá ser enviada.';



CREATE TABLE NOTIFICACAO_PESSOA (
    ID INTEGER NOT NULL,
    ID_NOTIFICACAO INTEGER NOT NULL,
    ID_PESSOA INTEGER NOT NULL,
    NOTIFICACAO_SISTEMA SMALLINT NOT NULL,
    NOTIFICACAO_EMAIL SMALLINT NOT NULL);

ALTER TABLE NOTIFICACAO_PESSOA
ADD CONSTRAINT PK_NOTIFICACAO_PESSOA
PRIMARY KEY (ID);

COMMENT ON COLUMN NOTIFICACAO_PESSOA.NOTIFICACAO_SISTEMA IS
'Recebera notificacao na tela de avisos do sistema
0 - Nao
1 - Sim';

COMMENT ON COLUMN NOTIFICACAO_PESSOA.NOTIFICACAO_EMAIL IS
'Recebera notificacao por e-mail
0 - Nao
1 - Sim';

CREATE SEQUENCE GEN_NOTIFICACAO_PESSOA;



ALTER TABLE NOTIFICACAO_PESSOA
ADD CONSTRAINT FK_NOTIFICACAO_PESSOA_1
FOREIGN KEY (ID_NOTIFICACAO)
REFERENCES NOTIFICACAO(ID)
ON UPDATE CASCADE;

ALTER TABLE NOTIFICACAO_PESSOA
ADD CONSTRAINT FK_NOTIFICACAO_PESSOA_2
FOREIGN KEY (ID_PESSOA)
REFERENCES PESSOA(ID)
ON UPDATE CASCADE;



CREATE TABLE CONTA_PAGAR_AUTORIZACAO (
    ID INTEGER NOT NULL,
    ID_CONTA_PAGAR INTEGER NOT NULL,
    ID_PESSOA INTEGER NOT NULL);

ALTER TABLE CONTA_PAGAR_AUTORIZACAO
ADD CONSTRAINT PK_CONTA_PAGAR_AUTORIZACAO
PRIMARY KEY (ID);

COMMENT ON COLUMN CONTA_PAGAR_AUTORIZACAO.ID_PESSOA IS
'Pessoa que autorizou o pagamento';

CREATE SEQUENCE GEN_CONTA_PAGAR_AUTORIZACAO;



ALTER TABLE CONTA_PAGAR_AUTORIZACAO
ADD CONSTRAINT FK_CONTA_PAGAR_AUTORIZACAO_1
FOREIGN KEY (ID_CONTA_PAGAR)
REFERENCES CONTA_PAGAR(ID)
ON UPDATE CASCADE;

ALTER TABLE CONTA_PAGAR_AUTORIZACAO
ADD CONSTRAINT FK_CONTA_PAGAR_AUTORIZACAO_2
FOREIGN KEY (ID_PESSOA)
REFERENCES PESSOA(ID)
ON UPDATE CASCADE;



ALTER TABLE CONTA_PAGAR_AUTORIZACAO
ADD CONSTRAINT UNQ1_CONTA_PAGAR_AUTORIZACAO
UNIQUE (ID_CONTA_PAGAR,ID_PESSOA);

